# 프로세스와 스레드

`프로세스` 프로그램을 메모리 위에서 실행 중인 작업

`스레드` 프로세스 안에서 실행되는 여러 흐름 단위

기본적으로! 프로세스마다 최소 1개의 스레드 소유(메인 스레드 포함)

![프로세스구조](https://github.com/kimmy01/Today.I.Learned/blob/main/images/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EA%B5%AC%EC%A1%B0.jpg)

프로세스는 각각 별도의 주소공간을 할당 (독립적)

* Code : 코드 자체를 구성하는 메모리 영역(프로그램 명령)
* Data: 전역변수, 정적변수, 배열 등
  * 초기화 된 데이터는 data 영역에 저장
  * 초기화 되지 않은 데이터는 bss영역에 저장(전역으로 선언된 초기화되지 않은 데이터 영역)

* Heap: 동적 할당 시 사용 (new(), malloc())
* Stack: 지역변수, 매개변수, 리턴 값(임시 메모리 영역)

스레드는 **Stack**만 따로 할당받고 나머지 영역은 서로 공유



`프로세스`는 자신만의 고유 공간과 자원을 할당받아서 사용

`스레드`는 다른 스레드와 공간, 자원을 공유하면서 사용



#### 멀티 프로세스

하나의 컴퓨터에 여러 개 CPU 장착, 하나 이상의 프로세스들을 동시에 처리(병렬)

**장점** : 안전성 (메모리 침범 문제를 OS 차원에서 해결 가능)

**단점** : 각각 독립된 메모리 영역 갖고 있어, 작업량 많을 수록 오버헤드 발생 => **Context Switching**으로 인한 성능 저하

​	**Context Switching**

​	프로세스의 상태 정보를 저장하고 복원하는 과정

​	동작 중인 프로세스가 대기 => 해당 프로세스 상태 보관 => 대기하고 있던 다음 순번 프로세스 동작 => 이전에 보관한 프로세스 상태 복구하는 과정

​	프로세스는 각각 독립된 메모리 영역을 할당받아 사용되므로 캐시 메모리 초기화 같은 무거운 작업이 진행되었을 때, 오버헤드가 발생할 문제 존재

#### 멀티 스레드

하나의 응용 프로그램에서 여러 스레드를 구성, 각 스레드가 하나의 작업을 처리

스레드들이 공유 메모리를 통해 다수의 작업을 동시에 처리하도록 함

**장점** : 독립적인 프로세스에 비해 공유 메모리만큼의 시간, 자원 손실이 감소. 전역 변수와 정적 변수에 대한 자료 공유 가능

**단점** : 안전성 문제. 하나의 스레드가 데이터 공간 망가뜨리면 모든 스레드가 작동 불능 상태(공유 메모리 갖기 때문)

멀티스레드의 안전성에 대한 단점은 *Critical Section* 기법을 통해서 대비함 (하나의 스레드가 공유 데이터 값을 변경하는 시점에 다른 스레드가 그 값을 읽으려고 할 때 발생하는 문제를 해결하기 위한 동기화 과정)
